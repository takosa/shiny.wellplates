(()=>{var e={638:(e,t,o)=>{"use strict";o.r(t),o.d(t,{MultiWellPicker:()=>p,PositionFormat:()=>n,RangeSelectionMode:()=>g,WellPlate:()=>v});var n,r,i,s=o(897),l=o.n(s);!function(e){e.Sequential="SEQUENTIAL",e.LetterNumber="LETTER_NUMBER",e.NumberNumber="NUMBER_NUMBER"}(n||(n={})),function(e){e.ByColumn="BY_COLUMN",e.ByRow="BY_ROW"}(r||(r={})),function(e){e.columns="BY_ROWS",e.rows="BY_COLUMNS",e.zone="ZONE"}(i||(i={}));class a{constructor(e){this.rows=e.rows,this.columns=e.columns;const{positionFormat:t=n.LetterNumber,iterationOrder:o=r.ByColumn}=e;this.positionFormat=t,this.iterationOrder=o,this.separator=e.separator||".",this.size=this.rows*this.columns,this.data=new Array(this.size)}[Symbol.iterator](){let e=-1;return{next:()=>{e++;const t=e===this.size;return{done:t,value:t?null:{index:e,position:this._getPositionFromIndex(e,this.iterationOrder),code:this._getFormattedPosition(e),data:this.getData(e)}}}}}_getPositionCode(e,t){if("number"==typeof e)switch(this._checkIndex(e),this.positionFormat){case n.Sequential:return String(e+1);case n.LetterNumber:{const o=this._getPositionFromIndex(e,t);return this._letterNumberCodeFromPosition(o)}case n.NumberNumber:{const o=this._getPositionFromIndex(e,t);return this._numberNumberCodeFromPosition(o)}default:throw new Error("Unreachable")}else{if("string"==typeof e){const t=this._getPosition(e);return this._getFormattedPosition(t)}switch(this._checkPosition(e),this.positionFormat){case n.Sequential:return this._sequentialCodeFromPosition(e);case n.LetterNumber:return this._letterNumberCodeFromPosition(e);case n.NumberNumber:return this._numberNumberCodeFromPosition(e);default:throw new Error("Unreachable")}}}_getFormattedPosition(e){return this._getPositionCode(e,this.iterationOrder)}getPositionSubset(e,t,o,n){if(o===i.zone)return this._getPositionCodeZone(e,t).map((e=>this.getPosition(e,n)));this._checkIndex(this._getIndex(e)),this._checkIndex(this._getIndex(t));const s=o===i.columns?r.ByRow:r.ByColumn,l="number"==typeof e?this._getPosition(e):e,a="number"==typeof t?this._getPosition(t):t;let u=this._getOrderedIndex(l,s),c=this._getOrderedIndex(a,s);u>c&&([u,c]=[c,u]);const d=c-u+1;return this._checkIndex(c),function(e,t){const o=[];for(let n=0;n<t;n++)o[n]=e+n;return o}(u,d).map((e=>s!==this.iterationOrder?this._getPositionFromIndex(e,s):e)).map((e=>this.getPosition(e,n)))}_getPositionCodeZone(e,t){const o=this._getPosition(e),n=this._getPosition(t);this._checkPosition(o),this._checkPosition(n);const r=Math.min(o.row,n.row),i=Math.min(o.column,n.column),s=Math.max(o.row,n.row),l=Math.max(o.column,n.column)-i+1,a=s-r+1,u=[];for(let e=0;e<a;e++)for(let t=0;t<l;t++)u.push({row:r+e,column:i+t});return u}_getOrderedIndex(e,t){if("number"==typeof e)return this._checkIndex(e),e;if("string"==typeof e)return this._getIndexFromCode(e,t);let o;return this._checkPosition(e),o=t===r.ByColumn?e.row*this.columns+e.column:e.column*this.rows+e.row,o}_getIndex(e){return this._getOrderedIndex(e,this.iterationOrder)}getData(e){const t=this._getIndex(e);return this.data[t]}setData(e,t){const o=this._getIndex(e);this.data[o]=t}getPosition(e,t){switch(t){case"index":return this._getIndex(e);case"row_column":return this._getPosition(e);case"formatted":return this._getFormattedPosition(e);default:throw new Error("unreachable")}}_getPosition(e){if("number"==typeof e)return this._checkIndex(e),this._getPositionFromIndex(e,this.iterationOrder);if("string"==typeof e){if(this.positionFormat===n.NumberNumber){const t=/^(?<row>\d+).(?<column>\d+)$/.exec(e);if(!e.includes(this.separator)||null===t||!t.groups)throw this._formatError();const o={row:+t.groups.row-1,column:+t.groups.column-1};return this._checkPosition(o),o}{const t=/^(?<row>[A-Z])(?<column>\d+)$/.exec(e);if(null===t||!t.groups){if(this.positionFormat!==n.Sequential)throw this._formatError();const t=+e-1;if(!Number.isInteger(t))throw this._formatError();if(Number.isNaN(t))throw this._formatError();return this._checkIndex(t),this._getPositionFromIndex(t,this.iterationOrder)}if(this.positionFormat!==n.LetterNumber)throw this._formatError();const o={row:t.groups.row.charCodeAt(0)-"A".charCodeAt(0),column:+t.groups.column-1};return this._checkPosition(o),o}}return e}get columnLabels(){const e=[];let t=1;for(let o=0;o<this.columns;o++)e.push(String(t++));return e}get rowLabels(){if(this.positionFormat!==n.LetterNumber){const e=[];let t=1;for(let o=0;o<this.rows;o++)e.push(String(t++));return e}{const e=[];let t="A".charCodeAt(0);for(let o=0;o<this.rows;o++)e.push(String.fromCharCode(t++));return e}}_getPositionFromIndex(e,t){return t===r.ByColumn?{row:Math.floor(e/this.columns),column:e%this.columns}:{row:e%this.rows,column:Math.floor(e/this.rows)}}_getIndexFromCode(e,t){return this._getOrderedIndex(this._getPosition(e),t)}_formatError(){switch(this.positionFormat){case n.LetterNumber:return new Error("invalid well code format. Must be a letter followed by a number");case n.Sequential:return new Error("invalid well code format. Must be an integer");case n.NumberNumber:return new Error(`invalid well code format. Must be 2 numbers separated by a ${this.separator}`);default:throw new Error("Unreachable")}}_checkIndex(e){if(e<0||e>=this.size)throw new RangeError("well position is out of range")}_checkPosition(e){if(e.row<0||e.row>=this.rows||e.column<0||e.column>=this.columns)throw new RangeError("well position is out of range")}_sequentialCodeFromPosition(e){return String(e.row*this.columns+e.column+1)}_letterNumberCodeFromPosition(e){const t="A".charCodeAt(0);return String.fromCharCode(t+e.row)+(e.column+1)}_numberNumberCodeFromPosition(e){return`${e.row+1}${this.separator}${e.column+1}`}}const u={borderRadius:"50%",borderWidth:1,borderStyle:"solid",display:"flex",alignItems:"center",textAlign:"center"},c=e=>{const{size:t,style:o}=e,n=Math.round(t/12),r={...u,width:t-2*n,height:t-2*n,margin:n,...o},i=e.text(e.value);return l().createElement("div",{onClick:e.onClick&&(t=>e.onClick(e.value,t)),onMouseEnter:e.onEnter&&(t=>e.onEnter(e.value,t)),onMouseLeave:e.onLeave&&(t=>e.onLeave(e.value,t)),onMouseUp:e.onMouseUp&&(t=>e.onMouseUp(e.value,t)),onMouseDown:e.onMouseDown&&(t=>e.onMouseDown(e.value,t)),className:e.className,style:r},l().createElement("div",{style:{width:"100%"}},void 0===i?e.wellPlate.getPosition(e.value,"formatted"):i))},d={userSelect:"none",WebkitUserSelect:"none"},m=e=>{const{displayAsGrid:t=!1}=e;return t?l().createElement(h,{...e}):l().createElement(w,{...e})};function h(e){const{plate:t}=e,o=t.columnLabels,n=t.rowLabels,r={borderStyle:"solid",borderColor:"gray",borderWidth:1},i=[];for(let e=0;e<=n.length-1;e++){i.push({index:void 0,label:n[e],isHeader:!0,position:{column:-1,row:e}});for(let n=0;n<=o.length-1;n++){const o={row:e,column:n},r=t.getPosition(o,"index");i.push({index:r,label:t.getPosition(o,"formatted"),isHeader:!1,position:o})}}return l().createElement("div",{style:{display:"grid",gridTemplateColumns:`max-content repeat(${o.length}, 1fr)`,gridTemplateRows:`max-content repeat(${n.length}, 1fr)`,...d,...r}},[{index:void 0,label:"",isHeader:!0,position:{row:-1,column:-1}},...o.map(((e,t)=>({index:void 0,label:e,isHeader:!0,position:{row:-1,column:t}}))),...i].map((({index:t,label:o,isHeader:n,position:i},s)=>{var a,u,c,d;if(n){const t={label:o,position:i},n=null===(a=e.headerText)||void 0===a?void 0:a.call(e,t);return l().createElement("div",{key:`header-${o}-${s}`,className:null===(u=e.headerClassName)||void 0===u?void 0:u.call(e,t),style:{...r,...null===(c=e.headerStyle)||void 0===c?void 0:c.call(e,t),padding:5,display:"flex",justifyContent:"center",alignItems:"center"}},void 0===n?o:n)}const m=null===(d=e.text)||void 0===d?void 0:d.call(e,t);return l().createElement("div",{style:{padding:5,display:"flex",justifyContent:"center",alignItems:"center",...r,...e.wellStyle(t)},key:t,className:e.wellClassName(t),onClick:e.onClick&&(o=>e.onClick(t,o)),onMouseEnter:e.onEnter&&(o=>e.onEnter(t,o)),onMouseLeave:e.onLeave&&(o=>e.onLeave(t,o)),onMouseUp:e.onMouseUp&&(o=>e.onMouseUp(t,o)),onMouseDown:e.onMouseDown&&(o=>e.onMouseDown(t,o))},l().createElement("div",null,void 0===m?o:m))})))}function w(e){const{plate:t,wellSize:o=40}=e,n=t.rowLabels,r=t.columnLabels,i={width:o,textAlign:"center"},s={width:o,height:o},a={display:"flex",alignItems:"center",height:o},u={paddingBottom:4,paddingRight:4,borderWidth:1,borderStyle:"solid",borderColor:"black",width:o*(t.columns+1)+4+1,...d},m=r.map(((t,o)=>{var n;return l().createElement("div",{key:t,style:{...i,...null===(n=e.headerStyle)||void 0===n?void 0:n.call(e,{label:t,position:{column:o,row:-1}})}},t)})),h=n.map(((n,u)=>{var d;const m=r.map(((n,r)=>{var i,a;const d=t.getPosition({row:u,column:r},"index");return l().createElement("div",{key:n,style:s},l().createElement(c,{wellPlate:t,className:null===(i=e.wellClassName)||void 0===i?void 0:i.call(e,d),style:null===(a=e.wellStyle)||void 0===a?void 0:a.call(e,d),onClick:e.onClick,onEnter:e.onEnter,onLeave:e.onLeave,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,text:e.text,value:d,size:o}))}));return l().createElement("div",{key:n,style:a},l().createElement("div",{style:{...i,...null===(d=e.headerStyle)||void 0===d?void 0:d.call(e,{label:n,position:{column:-1,row:u}})}},n),m)}));return l().createElement("div",{style:u},l().createElement("div",{style:a},l().createElement("div",{style:i}),m),h)}var g;!function(e){e.columns="columns",e.rows="rows",e.zone="zone",e.off="off"}(g||(g={}));const b={userSelect:"none",WebkitUserSelect:"none",cursor:"default"},f=({booked:e,disabled:t,selected:o})=>{const n={borderColor:"black"};return e&&(n.borderColor="orange"),t&&(n.backgroundColor="lightgray"),o&&(n.backgroundColor="lightgreen"),n},p=({rows:e,columns:t,format:o,value:n,renderText:r=(({label:e})=>e),disabled:u=[],onChange:c,style:d=f,className:h,rangeSelectionMode:w=g.zone,pickMode:p=!0,...v})=>{const x=(0,s.useMemo)((()=>new a({rows:e,columns:t,positionFormat:o})),[e,t,o]),_=(0,s.useMemo)((()=>new Set(n.map((e=>x.getPosition(e,"index"))))),[n,x]),y=(0,s.useMemo)((()=>new Set(u.map((e=>x.getPosition(e,"index"))))),[u,x]),[C,k]=(0,s.useState)(null),[E,S]=(0,s.useState)(new Set),M=(0,s.useCallback)(((e,t)=>{let o;switch(w){case g.zone:o=x.getPositionSubset(e,t,i.zone,"index");break;case g.columns:case g.rows:o=x.getPositionSubset(e,t,w===g.columns?i.columns:i.rows,"index");break;case g.off:return;default:throw new Error("invalid range selection mode")}S(new Set(o))}),[w,x]),N=(0,s.useCallback)((e=>{if(0===E.size)return;const t=[];for(let o of E)y.has(x.getPosition(o,"index"))||e&&_.has(o)||t.push(o);if(e)for(let e of _)E.has(e)||t.push(e);c(t,t.map((e=>x.getPosition(e,"formatted"))))}),[E,c,y,_,x]),I=(0,s.useCallback)((e=>{if(_.has(e)){const t=new Set(_);t.delete(e);const o=Array.from(t);c(o,o.map((e=>x.getPosition(e,"formatted"))))}else if(y.has(e));else{const t=[..._,e];c(t,t.map((e=>x.getPosition(e,"formatted"))))}}),[_,c,y,x]),F=(0,s.useCallback)((e=>{if(h)return h({booked:E.has(e),disabled:y.has(e),selected:_.has(e),label:x.getPosition(e,"formatted"),position:x.getPosition(e,"row_column"),index:e,wellPlate:x})}),[_,E,y,h,x]),L=(0,s.useCallback)((e=>{const t=x.getPosition(e,"formatted");return r({index:e,label:t,wellPlate:x,booked:E.has(e),position:x.getPosition(e,"row_column"),selected:_.has(e),disabled:y.has(e)})}),[r,x,E,_,y]),O=(0,s.useCallback)((e=>({...b,...null==d?void 0:d({booked:E.has(e),disabled:y.has(e),selected:_.has(e),index:e,label:x.getPosition(e,"formatted"),position:x.getPosition(e,"row_column"),wellPlate:x})})),[y,E,_,d,x]),U=(0,s.useCallback)((e=>{e.shiftKey||P(e)?N(!0):N(!1),k(null),S(new Set)}),[N]);return(0,s.useEffect)((()=>(window.addEventListener("mouseup",U),window.addEventListener("mouseleave",U),()=>{window.removeEventListener("mouseup",U),window.removeEventListener("mouseleave",U)})),[U]),l().createElement(m,{...v,plate:x,wellStyle:O,wellClassName:F,text:L,onEnter:e=>{null!==C&&M(C,e)},onLeave:e=>{C===e&&M(e,e)},onMouseDown:(e,t)=>{k(e),t.shiftKey||P(t)||(y.has(x.getPosition(e,"index"))?c([],[]):c([e],[x.getPosition(e,"formatted")]))},onClick:(e,t)=>{(t.shiftKey||P(t))&&p&&(I(e),t.stopPropagation())}})};function P(e){return"MacIntel"===navigator.platform?e.metaKey:e.ctrlKey}const v=e=>{const{rows:t,columns:o,format:n,onClick:r,onMouseDown:i,onMouseUp:u,onLeave:c,onEnter:d,wellStyle:h,wellClassName:w,renderText:g,headerStyle:b,...f}=e,p=(0,s.useMemo)((()=>new a({rows:t,columns:o,positionFormat:n})),[t,o,n]),P=(0,s.useCallback)(((e,t)=>{const o=p.getPosition(e,"formatted");r&&r(e,o,p,t)}),[r,p]),v=(0,s.useCallback)(((e,t)=>{const o=p.getPosition(e,"formatted");i&&i(e,o,p,t)}),[i,p]),x=(0,s.useCallback)(((e,t)=>{const o=p.getPosition(e,"formatted");c&&c(e,o,p,t)}),[c,p]),_=(0,s.useCallback)(((e,t)=>{const o=p.getPosition(e,"formatted");d&&d(e,o,p,t)}),[d,p]),y=(0,s.useCallback)((e=>{const t=p.getPosition(e,"formatted"),o=p.getPosition(e,"row_column");return{userSelect:"text",WebkitUserSelect:"text",...null==h?void 0:h({index:e,label:t,wellPlate:p,position:o})}}),[h,p]),C=(0,s.useCallback)((e=>({userSelect:"text",WebkitUserSelect:"text",...null==b?void 0:b(e)})),[b]),k=(0,s.useCallback)((e=>{const t=p.getPosition(e,"formatted"),o=p.getPosition(e,"row_column");if(w)return w({index:e,label:t,wellPlate:p,position:o})}),[w,p]),E=(0,s.useCallback)((e=>{const t=p.getPosition(e,"formatted"),o=p.getPosition(e,"row_column");return g?g({index:e,label:t,wellPlate:p,position:o}):t}),[g,p]);return l().createElement(m,{plate:p,onClick:P,text:E,onMouseDown:v,onLeave:x,onEnter:_,wellStyle:y,wellClassName:k,headerStyle:C,...f})}},908:e=>{"use strict";e.exports=jsmodule["@/shiny.react"]},897:e=>{"use strict";e.exports=jsmodule.react}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=o(638),{useState:t}=o(897),{InputAdapter:n}=o(908),r=n(e.MultiWellPicker,((e,t)=>({value:e,onChange:t}))),i=n((function({value:t,onChange:o,rows:n,columns:r,colors:i,...s}){return e.MultiWellPicker({value:t,onChange:o,rows:n,columns:r,style:({index:e,booked:t,disabled:o,selected:n,wellPlate:r})=>{let s={borderWidth:"2px"};return t&&(s.borderColor="orange"),o&&(s.backgroundColor="lightgray"),n?(s.borderColor="orange",s.backgroundColor="lightgreen"):s.backgroundColor=i[e],s},renderText:({index:e,label:t,wellPlate:o,booked:n,position:r,selected:i,disabled:s})=>null})}),((e,t)=>({value:e,onChange:t})));window.jsmodule={...window.jsmodule,"react-well-plates":e,"@/shiny.wellplates":{MultiWellPicker:r,ColorfullWellPicker:i}}})()})();